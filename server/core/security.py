from fastapi import Requestfrom datetime import datetime, timedeltaimport redis# اتصال به Redis برای مدیریت لاگین ناموفقr = redis.Redis(    host=os.getenv("REDIS_HOST", "localhost"),    port=int(os.getenv("REDIS_PORT", 6379)))def check_login_attempts(mobile: str):    key = f"login_attempts:{mobile}"    attempts = r.get(key)    if attempts and int(attempts) >= int(os.getenv("MAX_LOGIN_ATTEMPTS", 5)):        raise HTTPException(            status_code=status.HTTP_403_FORBIDDEN,            detail="Account temporarily locked"        )def increment_login_attempts(mobile: str):    key = f"login_attempts:{mobile}"    r.incr(key)    r.expire(key, timedelta(minutes=int(os.getenv("ACCOUNT_LOCK_TIME", 30))))def reset_login_attempts(mobile: str):    key = f"login_attempts:{mobile}"    r.delete(key)